<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaDailyBriefing Setup Wizard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7fa;
            color: #333;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        #setup-box {
            background: #fff;
            padding: 40px 50px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
            width: 100%;
            max-width: 600px;
            position: relative;
        }

        h1 { margin-top: 0; color: #005a9c; font-size: 1.8em; }
        h3 { margin-bottom: 10px; color: #333; }
        
        /* Tabs (Steps) */
        .tab { display: none; }
        
        /* Step Indicators */
        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
            color: #999;
            font-size: 0.9em;
        }
        .step-dot {
            height: 10px;
            width: 10px;
            margin: 0 4px;
            background-color: #ddd;
            border-radius: 50%;
            display: inline-block;
        }
        .step-dot.active { background-color: #005a9c; }

        /* Navigation Buttons */
        .buttons {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        button {
            background-color: #005a9c;
            color: #ffffff;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        button:hover { background-color: #004a80; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        button.secondary { background-color: #fff; color: #555; border: 1px solid #ccc; }
        button.secondary:hover { background-color: #f9f9f9; }

        /* Lists and Code */
        code {
            background: #f1f1f1;
            padding: 2px 6px;
            border-radius: 4px;
            color: #d63384;
            font-family: Consolas, monospace;
        }
        ul { padding-left: 20px; }
        li { margin-bottom: 10px; }
        
        .highlight-box {
            background: #eef7ff;
            border-left: 4px solid #005a9c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .btn-admin {
            display: block;
            text-align: center;
            width: 100%;
            background: #28a745;
            color: white;
            padding: 15px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 15px;
            box-sizing: border-box;
            transition: background 0.2s;
        }
        .btn-admin:hover { background: #218838; }

        /* Top Right Link */
        .top-link {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.85em;
            color: #999;
            text-decoration: none;
        }
        .top-link:hover { text-decoration: underline; color: #005a9c; }

    </style>
</head>
<body>

    <div id="setup-box">
        <a href="index.html" class="top-link">Back to Viewer</a>

        <div class="step-indicator">
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
        </div>

        <form id="setupForm" onsubmit="return false;">
            
            <!-- STEP 1: Welcome -->
            <div class="tab">
                <h1>Welcome</h1>
                <p>The <strong>Aqua Daily Briefing</strong> system helps you organize your day by combining your Outlook data with a web-based task list.</p>
                <div class="highlight-box">
                    <strong>How it works:</strong>
                    <ul>
                        <li><strong>Web Dashboard:</strong> You manage your Daily Tasks and Projects online.</li>
                        <li><strong>Outlook Agent:</strong> A small program runs on your PC to sync your emails and meetings automatically.</li>
                    </ul>
                </div>
                <p>Click <strong>Next</strong> to get started.</p>
            </div>

            <!-- STEP 2: Download -->
            <div class="tab">
                <h1>1. Download Agent</h1>
                <p>You need to copy the sync agent to your computer.</p>
                <p>Copy these <strong>2 files</strong> from <code>Q:\Support\MorningBriefing\</code> to your <code>G:\</code> drive:</p>
                <ul>
                    <li><code>AquaDailyBriefing.exe</code></li>
                    <li><code>dailybriefingconfig.txt</code></li>
                </ul>
                <p style="color: #666; font-size: 0.9em;">
                    <i>(Ensure you copy them to the main folder of your G: drive).</i>
                </p>
                <label style="display:block; margin-top:20px; cursor:pointer;">
                    <input type="checkbox" id="confirmDownload"> I have copied the 2 files to my G: drive.
                </label>
            </div>

            <!-- STEP 3: Admin Dashboard -->
            <div class="tab">
                <h1>2. Dashboard</h1>
                <p>This is where you manage your content online.</p>
                
                <div class="highlight-box" style="text-align:center;">
                    <p style="margin:0 0 10px 0;">Click below to open the dashboard:</p>
                    <a href="admin.html" target="_blank" class="btn-admin">Launch Dashboard</a>
                </div>
                
                <p><strong>Instructions:</strong></p>
                <ol>
                    <li>Log in using the <strong>Email/Password provided by IT</strong>.</li>
                    <li>Link your account to your <strong>Aqua Network ID</strong> (e.g., <code>jdoe</code>).</li>
                    <li>Add a test task to verify it works.</li>
                </ol>
                <p style="font-size:0.9em; color:#666;">Come back here and click Next once you are done.</p>
            </div>

            <!-- STEP 4: Configure -->
            <div class="tab">
                <h1>3. Configure Agent</h1>
                <p>Tell the Outlook Agent who you are.</p>
                <ol>
                    <li>Open <code>G:\dailybriefingconfig.txt</code>.</li>
                    <li>Change <code>ReportID=default</code> to your Network ID (e.g., <code>jdoe</code>).</li>
                    <li>Ensure <code>Prompt=Yes</code>.</li>
                    <li>Save and close the file.</li>
                </ol>
                <div class="highlight-box">
                    Example: <code>ReportID=jdoe</code>
                </div>
            </div>

            <!-- STEP 5: Run & Finish -->
            <div class="tab">
                <h1>4. Run & Sync</h1>
                <p>You are fully set up!</p>
                <ol>
                    <li>Double-click <code>G:\AquaDailyBriefing.exe</code>.</li>
                    <li>It will read your Outlook Emails & Meetings.</li>
                    <li>It will push them to the cloud and combine them with your web tasks.</li>
                </ol>
                <div class="highlight-box" style="border-color:#28a745; background:#e8f5e9;">
                    <strong>Success!</strong> You can now view your complete Daily Briefing.
                </div>
            </div>

            <!-- Navigation -->
            <div class="buttons">
                <button type="button" id="prevBtn" class="secondary" onclick="nextPrev(-1)">Previous</button>
                <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 0;
        showStep(currentStep);

        function showStep(n) {
            let tabs = document.getElementsByClassName("tab");
            tabs[n].style.display = "block";
            
            // Update dots
            let dots = document.getElementsByClassName("step-dot");
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            dots[n].className += " active";

            // Buttons
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            
            let nextBtn = document.getElementById("nextBtn");
            if (n == (tabs.length - 1)) {
                nextBtn.innerHTML = "Finish";
            } else {
                nextBtn.innerHTML = "Next";
            }

            // Logic for Step 2 Checkbox
            if (n == 1) {
                let chk = document.getElementById("confirmDownload");
                nextBtn.disabled = !chk.checked;
                chk.onclick = function() { nextBtn.disabled = !this.checked; };
            } else {
                nextBtn.disabled = false;
            }
        }

        function nextPrev(n) {
            let tabs = document.getElementsByClassName("tab");
            
            // If finished
            if (currentStep == (tabs.length - 1) && n == 1) {
                window.location.href = "index.html"; // Redirect to main viewer on finish
                return;
            }

            tabs[currentStep].style.display = "none";
            currentStep = currentStep + n;
            showStep(currentStep);
        }
    </script>
</body>
</html>