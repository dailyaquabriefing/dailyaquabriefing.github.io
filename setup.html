<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaDailyBriefing Setup Wizard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7fa;
            color: #333;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        #setup-box {
            background: #fff;
            padding: 40px 50px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
            width: 100%;
            max-width: 600px;
            position: relative;
        }

        h1 { margin-top: 0; color: #005a9c; font-size: 1.8em; }
        h3 { margin-bottom: 10px; color: #333; }
        
        /* Tabs (Steps) */
        .tab { display: none; }
        
        /* Step Indicators */
        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
            color: #999;
            font-size: 0.9em;
        }
        .step-dot {
            height: 10px;
            width: 10px;
            margin: 0 4px;
            background-color: #ddd;
            border-radius: 50%;
            display: inline-block;
        }
        .step-dot.active { background-color: #005a9c; }

        /* Navigation Buttons */
        .buttons {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        button {
            background-color: #005a9c;
            color: #ffffff;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        button:hover { background-color: #004a80; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        button.secondary { background-color: #fff; color: #555; border: 1px solid #ccc; }
        button.secondary:hover { background-color: #f9f9f9; }

        /* Lists and Code */
        code {
            background: #f1f1f1;
            padding: 2px 6px;
            border-radius: 4px;
            color: #d63384;
            font-family: Consolas, monospace;
        }
        ul { padding-left: 20px; }
        li { margin-bottom: 10px; }
        
        .highlight-box {
            background: #eef7ff;
            border-left: 4px solid #005a9c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .btn-admin {
            display: block;
            text-align: center;
            width: 100%;
            background: #28a745;
            color: white;
            padding: 15px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 15px;
            box-sizing: border-box;
            transition: background 0.2s;
        }
        .btn-admin:hover { background: #218838; }
        
        .btn-download {
            display: block;
            text-align: center;
            width: 100%;
            background: #6c757d;
            color: white;
            padding: 12px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            margin-top: 10px;
            box-sizing: border-box;
        }
        .btn-download:hover { background: #5a6268; }

        /* Top Right Link */
        .top-link {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.85em;
            color: #999;
            text-decoration: none;
        }
        .top-link:hover { text-decoration: underline; color: #005a9c; }

    </style>
</head>
<body>

    <div id="setup-box">
        <a href="index.html" class="top-link">Back to Viewer</a>

        <div class="step-indicator">
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
            <span class="step-dot"></span>
        </div>

        <form id="setupForm" onsubmit="return false;">
            
            <div class="tab">
                <h1>Welcome</h1>
                <p>The <strong>Aqua Daily Briefing</strong> system helps you organize your day by combining your Outlook data with a web-based task list.</p>
                <div class="highlight-box">
                    <strong>Note on Security:</strong>
                    <ul>
                        <li>Your <strong>Daily Briefing</strong> page (<code>?daily=YOUR_ID</code>) can be protected with a passcode, which you set on the Admin Dashboard.</li>
                        <li>Your <strong>Weekly Report</strong> page (<code>?report=YOUR_ID</code>) remains public for easy sharing.</li>
                    </ul>
                </div>
                <p>Click <strong>Next</strong> to get started.</p>
            </div>

            <div class="tab">
                <h1>1. Download & Install Agent</h1>
                <p>The setup program will manage file copying and configuration automatically.</p>
                
                <div class="highlight-box" style="text-align:center;">
                     <p style="margin:0 0 10px 0;">Click below to download the setup files:</p>
                     <a href="files/dailybriefing.zip" class="btn-download" download>Download dailybriefing.zip</a>
                </div>

                <p><strong>Instructions:</strong></p>
                <ol>
                    <li>Download the <code>dailybriefing.zip</code> file to your <strong>Downloads</strong> folder.</li>
                    <li>Unzip the file.</li>
                    <li>Run the setup program: <strong><code>AquaDailyBriefing.exe</code></strong> (uncheck "Always ask before opening this file").</li>
                    <li>The setup program will copy required files, place a <strong>shortcut on your desktop</strong>, and configure the sync agent to <strong>run upon login</strong>.</li>
                    <li>When prompted by the program, enter your <strong>Aqua Network User ID</strong> (e.g., <code>jdoe</code>).</li>
                </ol>
                <p>The program will then gather your Outlook information and prompt you to view your first daily briefing.</p>
            </div>

            <div class="tab">
                <h1>2. Dashboard & Passcode Setup</h1>
                <p>Use the web dashboard to manage your content and security settings online.</p>
                
                <div class="highlight-box" style="text-align:center;">
                    <p style="margin:0 0 10px 0;">Click below to open the dashboard:</p>
                    <a href="admin.html" target="_blank" class="btn-admin">Launch Dashboard</a>
                </div>
                
                <p><strong>Instructions:</strong></p>
                <ol>
                    <li>Log in using the <strong>Email/Password</strong> provided by IT.</li>
                    <li>Link your account to your <strong>Aqua Network ID</strong> (e.g., <code>jdoe</code>).</li>
                    <li>Navigate to the <strong>Settings</strong> tab and set a <strong>passcode</strong> for your Daily Briefing page (optional).</li>
                    <li>Add a <strong>test daily task</strong> to verify content creation works.</li>
                </ol>
                <p style="font-size:0.9em; color:#666;">Come back here and click Next once you are done.</p>
            </div>

            <div class="tab">
                <h1>3. View Agent Configuration</h1>
                <p>The agent is automatically configured during the setup process.</p>
                <p>The agent's configuration file:<br>(<code>C:\Users\[username]\AquaBriefing\dailybriefingconfig.txt</code>)<br>is set as follows:</p>
                
                <div class="highlight-box">
                    <strong>//confirm set to your Aqua Network UserID</strong><br>
                    <code>ReportID={Aqua Network UserID}</code><br>
                    <strong>//Recommended to keep the below default values</strong><br>
                    <code>Prompt=Yes</code> // Prompted when AquaDailyBriefing runs successfully<br>
                    <code>RunAtLogin=Yes</code> // Run AquaDailyBriefing automatically at login
                </div>
                
                <p style="color: #666; font-size: 0.9em;">
                    The setup program automatically updated the <strong>ReportID</strong> when you entered your Aqua Network User ID.
                </p>
            </div>

            <div class="tab">
                <h1>4. Run & Sync</h1>
                <p>You are fully set up!</p>
                
                <div class="highlight-box" style="border-color:#28a745; background:#e8f5e9;">
                    <strong>Sync Agent Status:</strong><br>
                    <ol style="margin-top: 5px;">
                        <li>The agent is configured to run automatically upon Windows login.</li>
                        <li>You can run the sync agent any time by double-clicking the new <strong>desktop shortcut</strong> for <strong>AquaDailyBriefing</strong>.</li>
                    </ol>
                </div>
                
                <p>Click <strong>Finish</strong> to go to your main viewer page.</p>
            </div>

            <div class="buttons">
                <button type="button" id="prevBtn" class="secondary" onclick="nextPrev(-1)">Previous</button>
                <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 0;
        showStep(currentStep);

        function showStep(n) {
            let tabs = document.getElementsByClassName("tab");
            
            // Check if element exists before accessing its style
            if(tabs.length > n) {
                tabs[n].style.display = "block";
            }
            
            // Update dots
            let dots = document.getElementsByClassName("step-dot");
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            if(dots.length > n) {
                dots[n].className += " active";
            }


            // Buttons
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            
            let nextBtn = document.getElementById("nextBtn");
            if (n == (tabs.length - 1)) {
                nextBtn.innerHTML = "Finish";
            } else {
                nextBtn.innerHTML = "Next";
            }

            // Removed old Step 1 Checkbox logic (Step 2 in old numbering)
            // Re-enabling the Next button for all steps
            nextBtn.disabled = false;
        }

        function nextPrev(n) {
            let tabs = document.getElementsByClassName("tab");
            
            // If finished
            if (currentStep == (tabs.length - 1) && n == 1) {
                window.location.href = "index.html"; // Redirect to main viewer on finish
                return;
            }

            tabs[currentStep].style.display = "none";
            currentStep = currentStep + n;
            showStep(currentStep);
        }
    </script>
</body>
</html>